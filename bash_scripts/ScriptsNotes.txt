
# First, find the usearch executable
# Add usearch executable to PATH (need to run for each job that need to call usearch)
export PATH=$PATH:/software/usearch/9.2.64/bin

# Now usearch is callable in any place.

# pull latest shortbread image from docker:
module load singularity
singularity pull docker://biobakery/shortbred
# /projects/p31421/Images

# blast
module load blast/2.7.1
export PATH=$PATH:/software/blast/ncbi-blast-2.7.1+/bin

# Add metaWrap to path
source activate metawrap-env
export PATH=$PATH:/projects/p31421/software/metaWRAP/bin

sample=($(cat SampleNames.txt))
sample+=("raw_greywater_merged")

#convert fastq.gz to fasta
for i in {0..13}
do
	gunzip ${sample[$i]}_*_paired_1.fastq.gz
	cat ${sample[$i]}_*_paired_1.fastq | awk '{if(NR%4==1) {printf(">%s\n",substr($0,2));} else if(NR%4==2) print;}' > ${sample[$i]}_*_paired_1.fasta
	gzip ${sample[$i]}_*_paired_1.fastq
done
